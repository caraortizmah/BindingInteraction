<p>&nbsp;</p>
<h1 style="color: #5e9ca0;">The <span style="color: #3366ff;">MHC</span> BindingInteraction pipeline <span style="color: #999999;">Manual</span></h1>
<h2><span style="color: #008080;">Overall</span></h2>
<p><span style="color: #008080;"><span style="color: #333399;">The MHCBI pipeline has four stages (last stage is optional) in which each stage has its own algorithm. Named here as steps, each one has a main work:</span></span></p>
<p><span style="color: #008080;"><span style="color: #333399;"><span style="background-color: #ff6600;"><strong>First step</strong></span> modifies PDB structure (input) adding waters through Dowser program and performs some optimization procedures for refining PDB geometry. At the end of this step a PDB file and .arc file (MOPAC output) are used as input for the <strong><span style="color: #333399; background-color: #ff6600;">Second step</span></strong>.</span></span></p>
<p><span style="color: #008080;"><span style="color: #333399;"><strong><span style="color: #333399; background-color: #ff6600;">Second step</span></strong> uses <span style="background-color: #ff6600;"><strong>First step </strong></span>output and listm.log for building new structures according to the written orders in listm.log, those new structures are named here as mutations.</span></span></p>
<p><span style="color: #008080;"><span style="color: #333399;">Each mutation is performed by Dunbrack library in chimera program, it is possible to build mutiple amino acid changes for the same PDB structure. To sum up, <strong><span style="color: #333399; background-color: #ff6600;">Second step</span></strong> creates new similar protein geometries from the initial PDB structure in the <span style="background-color: #ff6600;"><strong>First step</strong></span>.&nbsp; </span></span><span style="color: #008080;"><span style="color: #333399;">After creating new geometries, <strong><span style="color: #333399; background-color: #ff6600;">Second step</span></strong> performs partial optimizations.</span></span></p>
<p><span style="color: #008080;"><span style="color: #333399;">listm.log file has the using instructions for creating new PDB structures. Read completely listm.log file before writing your mutation list. There are two examples of writing mutation list for mono- and multiple-substitutions. The only part that you are going to change is explicitly explained in the listm.log between</span></span></p>
<p><code>*** Begin</code></p>
<p><span style="color: #008080;"><span style="color: #333399;">and (Changes must be here)</span></span></p>
<p><code>*** End</code></p>
<p><span style="color: #333399;">In this frame there is an example that you can use or remove according your necessities, in the example there are ten mono-substitutions named as P01, P02, until P10. Amino acid that will be used in this example is Lysine for the ten cases for positions 1 up to 10 in the chain P from PDB structure.</span></p>
<p><span style="color: #333399;">At the end of the <span style="color: #008080;"><strong><span style="color: #333399; background-color: #ff6600;">Second step</span></strong></span> performance the output is created as <span style="background-color: #ccffff;">tobe_charged</span> folder. Inside that folder there are all new PDB structures partially optimized, the initial PDB structure and the list of 8-angstrom-distance residues from the ligand (main part of protein binding region) that could be protonated or deprotonated.</span></p>
<p><span style="color: #333399;"><strong><span style="color: #333399; background-color: #ff6600;">Third step</span></strong> uses <span style="background-color: #ccffff;">tobe_charged</span> folder (<span style="color: #008080;"><strong><span style="color: #333399; background-color: #ff6600;">Second step</span></strong></span> output) as input for using propka 3.1 for protonating and deprotonating residues in each PDB structure (geometries set) and performs single points throught MOPAC splitting each PDB structure in Complex, Receptor and Ligand. At the end output is generated as <span style="background-color: #ccffff;">final_pdbs</span> and <span style="background-color: #ccffff;">be_outputs</span> folders. In the first folder there are the PDB files that will be used for creating FMO GAMESS input (optional) and in the second folder there are .arc files that contains the energy (HEAT OF FORMATION - Kcal/mol) that user will use for computing binding energies.</span></p>
<p><span style="color: #333399;">Optional <strong><span style="color: #333399; background-color: #ff6600;">Fourth step</span></strong> uses <span style="background-color: #ccffff;">final_pdbs</span> folder as input for creating input for GAMESS computations. This step depends on user supervision due to the GUI Facio environment. You have to put your GAMESS inputs in the same PDB structures place.</span></p>
<p><span style="color: #333399;">All hierarchy of each step is explained below (go to hierarchy).</span></p>

<h2><span style="color: #008080;">Take into account</span></h2>
<p><span style="color: #333399;">After performing all steps in the installing instructions you can run the pipeline over a <span style="background-color: #ccffff;"><em>new proyect</em></span>.</span></p>
<pre><span style="background-color: #ccffcc;"><code>$ ./pre-run.sh</code></span></pre>
<p><span style="color: #333399;">You have to complete all steps in order. <span style="background-color: #ff6600;"><strong>First step</strong></span> is aimed to set some paths prior to run a <span style="background-color: #ccffff;"><em>new proyect</em></span>:</span></p>
<hr />
<p><em><span style="color: #333399;">Notepadding:&nbsp;</span></em><span style="color: #333399;">A <span style="background-color: #ccffff;"><em>new proyect</em></span> is a work performed by MHCBI pipeline passing through the three stages: optimizations, mutations and calculations. All folders, inputs and outputs created during the whole process are the <span style="background-color: #ccffff;"><em>new proyect</em></span>. Each individual PDB structure has one <span style="background-color: #ccffff;"><em>new proyect</em></span>.</span></p>
<hr />
<p><span style="color: #333399;"><strong><span style="text-decoration: underline;">PDB structure path</span></strong> is the directory where is placed the <span style="background-color: #ccffff;"><em>new proyect</em></span> PDB structure.</span></p>
<p><span style="color: #333399;"><span style="text-decoration: underline;"><strong>PDB structure name</strong></span>&nbsp;is the PDB structure (located in the previous path). A PDB format can have several valid formats, however in this MHCBI pipeline, format has the following guideline:</span></p>
<p style="padding-left: 30px;"><span style="color: #333399;">&nbsp; &nbsp;1.&nbsp; PDB structures having a <span style="background-color: #ccffff;">receptor-ligand MHC-like</span></span></p>
<p><span style="color: #333399;">Receptor has to be named as <strong>chain A and B</strong> and l</span><span style="color: #333399;">igand as <strong>chain P</strong>. In case of having crystallographic water molecules, all of them must be named as <strong>chain V</strong>.</span></p>
<p style="padding-left: 30px;"><span style="color: #333399;">&nbsp; &nbsp;2.&nbsp; PDB structures having a <span style="background-color: #ccffff;">12-column features</span></span></p>
<p><span style="color: #333399;">In <em>test</em> folder there are two examples (shortened 1BX2 and 3OXS) having 12-column features as it should be used for every PDB structure in any proyect. In the PDB structure for a <em><span style="background-color: #ccffff;">new proyect</span></em> remove all information not related with 3D atomic coordinates.</span></p>
<p style="padding-left: 30px;"><span style="color: #333399;">&nbsp; &nbsp;3.&nbsp; PDB structures name </span></p>
<p><span style="color: #333399;">PDB structure names have to be named only with alpha-numeric characters and wihtout any blank space. Remove any special character (#$/!@'Â´{}}}}), even any kind of hyphen (-_), or punctuation (.,:;) in your PDB structure names for your <em><span style="background-color: #ccffff;">new proyects</span></em>.</span></p>
<p><span style="color: #333399;"><span style="text-decoration: underline;"><strong>to-do work path</strong></span> is the directory where you want to place the <span style="background-color: #ccffff;"><em>new proyect</em></span>.</span></p>
<p><span style="color: #333399;"><span style="text-decoration: underline;"><strong>name of your work</strong></span>&nbsp;is the name of your <em><span style="background-color: #ccffff;">new proyect</span></em>.</span></p>
<p>&nbsp;</p>
<p><span style="color: #333399;">Setup and pre-run scripts create .log files having all required paths. You can modify them without using the pipeline, but you can not change any word related to the format. It is advisable to use the pipeline for setting paths.</span></p>
<p><span style="color: #333399;">In pre-run script,&nbsp;</span><span style="color: #333399; background-color: #ff6600;">Second step</span><span style="color: #333399;">&nbsp;configures pipeline core in all of the new folders that will be the <span style="background-color: #ccffff;"><em>new proyect</em></span>. If the MHCBI can not detect one of the required paths, configuration step will not be performed.</span></p>
<p><span style="color: #333399;">After configuring the <span style="background-color: #ccffff;"><em>new proyect</em></span> you can run the pipeline. <span style="background-color: #ff6600;">Third step</span> presents two options for running MHCBI over a PDB structure:</span></p>
<p style="padding-left: 30px;"><span style="color: #333399;">&nbsp; &nbsp;1.&nbsp; Performing the three-stage methodology in a single step.</span></p>
<p style="padding-left: 30px;"><span style="color: #333399;">&nbsp; &nbsp;2.&nbsp;&nbsp;Performing the three-stage methodology step by step.</span></p>
<p>&nbsp;</p>
<h2><span style="color: #008080;">To sum up</span></h2>
<table class="editorDemoTable" style="width: 1000px;" border="1">
<thead>
<tr>
<td style="width: 45px;">Step</td>
<td style="width: 480px;">Instruction</td>
<td style="width: 600px;">Command</td>
</tr>
</thead>
<tbody>
<tr>
<td style="width: 45px;">1</td>
<td style="width: 480px;">Set work and PDB directories</td>
<td style="width: 600px;">
<p>./pre-run.sh (option 1)</p>
</td>
</tr>
<tr>
<td style="width: 45px;">2</td>
<td style="width: 480px;">Configure folders and scripts for the <span style="background-color: #99ccff;"><em>new proyect</em></span></td>
<td style="width: 600px;">
<p>./pre-run.sh (option 2)</p>
</td>
</tr>
<tr>
<td style="width: 45px;">3</td>
<td style="width: 480px;">Run the MHCBI pipeline</td>
<td style="width: 600px;">
<p>./pre-run.sh (option 3)</p>
</td>
</tr>
</tbody>
</table>
<p><strong>&nbsp;</strong></p>
<p><span style="color: #0000ff;"><strong>Now you can analyse your results!</strong></span></p>
<p><strong>&nbsp;</strong></p>
<p><span style="color: #0000ff;"><strong>Warnnings!</strong></span></p>
<p>Some Open Babel operations generate messages that could be frightening, however those messages are atoms (ATOM) in PDB format named as HETATM by Dowser operations, do not worry about it.</p>
<p>When Dowser puts waters, some conversions by OpenBabel generates some warnings that look like:</p>
<p><code>=============================</code><br /><code>*** Open Babel Warning in parseAtomRecord</code><br /><code>WARNING: Problems reading a PDB file</code><br /><code>Problems reading a HETATM or ATOM record.</code><br /><code>According to the PDB specification,</code><br /><code>columns 77-78 should contain the element symbol of an atom.</code><br /><code>but OpenBabel found ' ' (atom 3)</code><br /><code>==============================</code></p>
<p>In case of not finding waters by Dowser, messages like this could appear:</p>
<p><code>PDB file '/home/work_path/work_name/../dowser/1_iter/placed_waters_1.pdb' contains no atoms.</code><br /><code>PDB file '/home/work_path/work_name/../dowser/1_iter/placed_waters_2.pdb' contains no atoms.</code><br /><code>PDB file '/home/work_path/work_name/../dowser/1_iter/placed_waters_3.pdb' contains no atoms.</code><br /><code>1 molecule converted</code></p>
<p>&nbsp;</p>
<p>The following message could appear due to a non-existent binary path related to another process in vmd:</p>
<p><code>rlwrap: Command not found.</code></p>
<p>That message do not affect the <span style="background-color: #99ccff;">MHCBI</span> performance.</p>
<p>&nbsp;</p>
